---
import BeginHead from './BeginHead.astro';
import JsonLd from './JsonLd.astro';

/**
 * `<head>`コンポーネントのProps。
 */
 interface Props {
  /**
   * サイト全体の設定。
   */
  site: {
    /**
     * ウェブサイトのドメイン名 (例: 'example.com')。
     */
    domain: string;
    /**
     * ウェブサイトの名前。
     */
    siteName: string;
    /**
     * ロゴのパス。
     */
    logo: string;
    /**
     * ファビコンファイルのパス。
     */
    favicon: string;
    /**
     * デフォルトのOpen Graphイメージのパス。
     */
    ogImg: string;
    /**
     * オプション: SVGアイコンファイルのパス。
     */
    svgIcon?: string;
    /**
     * オプション: Apple touch iconファイルのパス。
     */
    touchIcon?: string;
    /**
     * オプション: Facebook App ID。
     */
    facebookID?: string;
    /**
     * オプション: Twitterのユーザー名 (@マークを除く)。
     */
    twitterName?: string;
    /**
     * オプション: ウェブフォントのスタイルシートのURL。
     */
    webfont?: string;
  };
  /**
   * ページ固有の情報。
   */
  page: {
    /**
     * 現在のページのslugまたは識別子。通常、ホームページには 'top' が使用されます。
     */
    slug: string;
    /**
     * 現在のページのタイトル。
     */
    ttl: string;
    /**
     * 現在のページの説明。
     */
    description: string;
    /**
     * 現在のページのURLパス (例: '/about')。
     */
    url: string;
  };
  /**
   * イベント情報（JSON-LD用）。
   */
  event?: {
    /**
     * イベント名。
     */
    name: string;
    /**
     * イベント開始日 (ISO 8601形式)。
     */
    startDate: string;
    /**
     * イベント終了日 (ISO 8601形式)。
     */
    endDate: string;
    /**
     * イベントの説明。
     */
    description: string;
    /**
     * イベント画像のURL配列。
     */
    image: string[];
    /**
     * イベント開催地情報。
     */
    location: {
      /**
       * 会場名。
       */
      name: string;
      /**
       * 住所情報。
       */
      address: {
        /**
         * 番地・建物名。
         */
        streetAddress: string;
        /**
         * 市区町村。
         */
        addressLocality: string;
        /**
         * 郵便番号。
         */
        postalCode: string;
        /**
         * 都道府県。
         */
        addressRegion: string;
      };
    };
  };
}

const {
  site,
  page,
  event
} = Astro.props;
---

<head
	prefix={page.slug == "top"
		? "og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# website: http://ogp.me/ns/website#"
		: "og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# http://ogp.me/ns/fb# article: http://ogp.me/ns/article#"}
>
	<meta charset="utf-8" />
  <BeginHead />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width,initial-scale=1.0,shrink-to-fit=no" />
	<meta name="format-detection" content="telephone=no" />
	<title>{page.ttl}</title>
	<meta name="description" content={page.description} />
	<meta property="og:type" content={page.slug == "top" ? "website" : "article"} />
	<meta property="og:local" content="ja_JP" />
	<meta property="og:site_name" content={site.siteName} />
	<meta property="og:title" content={page.ttl} />
	<meta property="og:description" content={page.description} />
	<meta property="og:url" content={site.domain + page.url} />
	<meta property="og:image" content={site.ogImg} />
  {site.facebookID && (
    <meta property="fb:app_id", content={site.facebookID} />
  )}
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:title" content={page.ttl} />
	<meta name="twitter:description" content={page.description} />
	<meta name="twitter:image" content={site.ogImg} />
  {site.twitterName && (
    <meta name="twitter:site", content={"@" + site.twitterName} />
  )}
	<link rel="icon" href={site.favicon} sizes="32x32" />
  {site.svgIcon && (
    <link rel="icon" href={site.svgIcon} type="image/svg+xml" />
  )}
  {site.touchIcon && (
    <link rel="apple-touch-icon" href={site.touchIcon} />
  )}
	<link rel="canonical" href={site.domain + page.url} />
  {site.webfont &&(
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preload" href={site.webfont} as="style" onload="this.onload=null;this.rel='stylesheet'"/>
    <noscript>
      <link rel="stylesheet" href={site.webfont}>
    </noscript>
  )}
    <JsonLd site={site} page={page} event={event} />
</head>
